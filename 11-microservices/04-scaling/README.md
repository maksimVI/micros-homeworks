
# Домашнее задание к занятию «Микросервисы: масштабирование»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развёртывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- поддержка контейнеров;
- обеспечивать обнаружение сервисов и маршрутизацию запросов;
- обеспечивать возможность горизонтального масштабирования;
- обеспечивать возможность автоматического масштабирования;
- обеспечивать явное разделение ресурсов, доступных извне и внутри системы;
- обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т. п.

Обоснуйте свой выбор.

## Ответ 1

Для решения задачи можно использовать Kubernetes - это оркестратор контейнеров, обеспечивающий управление контейнерными приложениями на кластере.

### Решение будет состоять из компонентов

1. Kubernetes
2. Docker или containerd - система контейнеризации для создания и управления контейнерами. Это отдельные системы контейнеризации, которые используются Kubernetes для запуска контейнеров, но сами по себе не являются его частью.
3. Ingress Controller или Service Mesh (например, Istio или Linkerd) - для управления обнаружением сервисов и маршрутизацией запросов. Это расширение, работающие внутри кластера Kubernetes, но это не часть стандартной поставки Kubernetes, а дополнительный компонент.
4. Horizontal Pod Autoscaler - компонент Kubernetes для автоматического масштабирования приложений. Это встроенный компонент Kubernetes для масштабирования подов.
5. ConfigMaps и Secrets - инструменты Kubernetes для конфигурирования приложений и безопасного хранения чувствительных данных. Это встроенные механизмы Kubernetes для хранения конфигурации и секретов.

### Способы и принципы взаимодействия

**Поддержка контейнеров**
Kubernetes основывается на контейнерной технологии, такой как Docker или containerd, для упаковки и изоляции приложений. Создавая образы контейнеров, мы упрощаем переносимость и консистентность среды выполнения.

**Обнаружение сервисов и маршрутизация запросов**
Kubernetes предоставляет встроенные механизмы для обнаружения сервисов. Сервисы автоматически регистрируются в DNS-системе кластера, что упрощает взаимодействие микросервисов друг с другом. Для маршрутизации внешних HTTP и HTTPS запросов к конкретным сервисам в кластере может использоваться Ingress Controller или Service Mesh, такие как Istio, которые также добавляют возможности для управления трафиком и обеспечения безопасности.

**Горизонтальное и автоматическое масштабирование**
Горизонтальное масштабирование в Kubernetes достигается за счет изменения количества экземпляров (Pod’ов) приложения, что может быть сделано вручную или автоматически. Для автоматического масштабирования используется Horizontal Pod Autoscaler (компонент Kubernetes для автоматического масштабирования приложений), который отслеживает метрики (такие как загрузка CPU, память) и масштабирует приложение в зависимости от нагрузки.

**Явное разделение ресурсов, доступных извне и внутри системы**
Kubernetes использует пространство имен (Namespaces) для логического разделения ресурсов между различными проектами или подразделениями внутри кластера. Это позволяет ограничивать доступ и управлять изоляцией компонентов. Кроме того, с помощью Network Policies можно определять сетевые правила доступа как внутри кластера, так и извне.

**Конфигурирование приложений и безопасное хранение данных**
Kubernetes предоставляет инструмент ConfigMaps для хранения конфигурационных данных, которые могут быть легко изменены без пересборки контейнеров. Для безопасного хранения чувствительной информации, такой как пароли и ключи, используются Secrets (тоже инструмент Kubernetes). Эти объекты безопасно интегрируются в окружение контейнеров в момент запуска, минимизируя риски несанкционированного доступа.

## Задача 2: Распределённый кеш * (необязательная)

Разработчикам вашей компании понадобился распределённый кеш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster, состоящий из трёх шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
